<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>FAQ • ggalign</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FAQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggalign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="https://yunuuuu.github.io/ggalign-book/" aria-label="Tutorial"><span class="fa fa-solid fa-book"></span> Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/benchmarks.html"><span class="fa fa-solid fa-chart-line"></span> Benchmarks</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/FAQ.html"><span class="fa fa-solid fa-clipboard-question"></span> FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Yunuuuu/ggalign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>FAQ</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Yunuuuu/ggalign/blob/v1.0.1/vignettes/articles/FAQ.Rmd" class="external-link"><code>vignettes/articles/FAQ.Rmd</code></a></small>
      <div class="d-none name"><code>FAQ.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Yunuuuu/ggalign" class="external-link">ggalign</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span></code></pre></div>
<div class="section level2">
<h2 id="how-to-arrange-ggalign-objects-with-other-ggplot2-or-grid-objects">How to arrange ggalign objects with other ggplot2 or grid
objects?<a class="anchor" aria-label="anchor" href="#how-to-arrange-ggalign-objects-with-other-ggplot2-or-grid-objects"></a>
</h2>
<p><code><a href="../reference/align_plots.html">align_plots()</a></code> function can arrange the ggplot2 objects,
and it can also accept objects from <code>ggalign</code>,
<code>ComplexHeatmap</code>, <code>pheatmap</code> directly. It behaves
similar with <code>pathwork::wrap_plots()</code>, but it cannot add tags
(the “A”, “B”, “C”, “D” in the top-left corner) — I prefer to add tags
manually using Inkscape or Illustrator.</p>
<p>If you wish to use other packages to arrange your plots, you can use
the <code><a href="../reference/ggalignGrob.html">ggalignGrob()</a></code> function to convert <code>ggalign</code>
objects into a grob. This allows you to arrange them alongside other
plots or annotations using <code>patchwork</code>, <code>cowplot</code>,
or <code>ggpubr</code>. However, note that in this case, the plot panels
of the <code>ggalign</code> <strong>Layout</strong> object won’t be
aligned with the ggplot2 plot panel.</p>
</div>
<div class="section level2">
<h2 id="how-to-customize-the-gene-ordering-in-ggoncoplot-function">How to customize the gene ordering in ggoncoplot function?<a class="anchor" aria-label="anchor" href="#how-to-customize-the-gene-ordering-in-ggoncoplot-function"></a>
</h2>
<p>To manually define the row (gene) and column (sample) order in
<code><a href="../reference/ggoncoplot.html">ggoncoplot()</a></code>, you first need to disable the automatic
ordering applied by <code><a href="../reference/ggoncoplot.html">ggoncoplot()</a></code>. Then, you can use the
<code><a href="../reference/align_order.html">align_order()</a></code> function to specify the desired
arrangement.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample data</span></span>
<span><span class="va">mut_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/textconnections.html" class="external-link">textConnection</a></span><span class="op">(</span></span>
<span>        <span class="st">"s1,s2,s3</span></span>
<span><span class="st">         snv;indel,snv,indel</span></span>
<span><span class="st">         ,snv;indel,snv</span></span>
<span><span class="st">         snv,,indel;snv"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mut_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g1"</span>, <span class="st">"g2"</span>, <span class="st">"g3"</span><span class="op">)</span></span>
<span><span class="va">mut_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mut_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example 1: Manually order rows using numeric indices</span></span>
<span><span class="fu"><a href="../reference/ggoncoplot.html">ggoncoplot</a></span><span class="op">(</span></span>
<span>    <span class="va">mut_mat</span>,</span>
<span>    map_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>snv <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    map_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>indel <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    reorder_row <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Use anno_left() or anno_right() for row ordering; for columns, use anno_top() or anno_bottom()</span></span>
<span>    <span class="fu"><a href="../reference/quad_active.html">anno_left</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/align_order.html">align_order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># Orders rows as g2, g3, g1</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 2: Manually order rows using row names</span></span>
<span><span class="fu"><a href="../reference/ggoncoplot.html">ggoncoplot</a></span><span class="op">(</span></span>
<span>    <span class="va">mut_mat</span>,</span>
<span>    map_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>snv <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    map_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>indel <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    reorder_row <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/quad_active.html">anno_left</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/align_order.html">align_order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g2"</span>, <span class="st">"g1"</span>, <span class="st">"g3"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Orders rows as g2, g1, g3</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>For row ordering, you can use either numeric indices (e.g., c(2, 3,
1)) or character names (e.g., c(“g2”, “g1”, “g3”)) if your matrix has
row names. For column ordering, simply replace <code><a href="../reference/quad_active.html">anno_left()</a></code>
with <code><a href="../reference/quad_active.html">anno_top()</a></code> or <code><a href="../reference/quad_active.html">anno_bottom()</a></code> and specify
the sample order in <code><a href="../reference/align_order.html">align_order()</a></code>. Note the ordering
specified is from bottom to the top or from left to the right which
following the ggplot2 coordinates.</p>
<p>For certain objects related to <code><a href="../reference/ggoncoplot.html">ggoncoplot()</a></code>, the
<code><a href="../reference/fortify_matrix.html">fortify_matrix()</a></code> method includes a <code>genes</code>
argument that allows manual specification of gene order (character
only). You can define this argument directly within
<code><a href="../reference/ggoncoplot.html">ggoncoplot()</a></code>, Currently, the supported objects for
oncoplot-specific usage include:</p>
<ul>
<li><code>maftools</code></li>
<li>a matrix wrapped with <code>tune(matrix, "oncoplot")</code>
</li>
</ul>
<p>The primary reason we must wrap a standard matrix with
<code><a href="../reference/tune.html">tune()</a></code> is that <code><a href="../reference/fortify_matrix.html">fortify_matrix()</a></code> cannot
distinguish between the default matrix method and the one specifically
intended for <code><a href="../reference/ggoncoplot.html">ggoncoplot()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggoncoplot.html">ggoncoplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/tune.html">tune</a></span><span class="op">(</span><span class="va">mut_mat</span>, <span class="st">"oncoplot"</span><span class="op">)</span>,</span>
<span>    genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g2"</span>, <span class="st">"g1"</span>, <span class="st">"g3"</span><span class="op">)</span>, <span class="co"># Orders rows as g2, g1, g3</span></span>
<span>    map_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>snv <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    map_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>indel <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    reorder_row <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="can-i-change-the-default-data-for-all-geoms">Can I change the default data for all geoms?<a class="anchor" aria-label="anchor" href="#can-i-change-the-default-data-for-all-geoms"></a>
</h2>
<p>All function in <code>ggalign</code> requires specific data formats
for its operations. If you need to transform or filter data for
individual <code>geoms</code>, you can use the <code>data</code>
argument within each <code>geom</code>. However, if you have multiple
<code>geoms</code> and want a consistent transformation applied across
all, you can utilize the <code><a href="../reference/scheme_data.html">scheme_data()</a></code> function which
allows you to transform the default data for all additive geoms.</p>
</div>
<div class="section level2">
<h2 id="why-are-there-spaces-after-setting-all-plot-margin-to-zero">Why are there spaces after setting all <code>plot.margin</code> to
zero?<a class="anchor" aria-label="anchor" href="#why-are-there-spaces-after-setting-all-plot-margin-to-zero"></a>
</h2>
<p>By default, ggalign doesn’t add spaces between plots. If you notice
spaces, they are likely due to:</p>
<ul>
<li>Plot margins within individual plots.</li>
<li>Scale expansion automatically added by ggplot2.</li>
</ul>
<p>You can resolve this by removing the scale expansion and adjusting
the margins in the theme:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">small_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">81</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heatmap_layout.html">ggheatmap</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/quad_active.html">anno_top</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/align_dendro.html">align_dendro</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">branch</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; → heatmap built with `geom_tile()`</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="why-cant-i-add-two-dendrograms-with-different-reorder-settings">Why can’t I add two dendrograms with different <code>reorder</code>
settings?<a class="anchor" aria-label="anchor" href="#why-cant-i-add-two-dendrograms-with-different-reorder-settings"></a>
</h2>
<blockquote>
<p>Note: We always prevent users from reordering layout direction
twice.</p>
</blockquote>
<p>When <code>reorder_group = FALSE</code> is used, reordering of the
heatmap occurs within each group. As long as the ordering within each
group remains consistent, these two dendrograms can be placed on the
same axis of the heatmap.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">small_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">81</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s assume that panels represents the group for each observation
and index represents the ordered index of the observations.</p>
<p>In the code provided, panels is initialized as ungrouped and index as
unordered:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">panels</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/heatmap_layout.html">ggheatmap</a></span><span class="op">(</span><span class="va">small_mat</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/quad_active.html">anno_top</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/align_group.html">align_group</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>When we add a dendrogram with <code>reorder_group = FALSE</code>;
this’ll do something like this (Since
<code>reorder_group = FALSE</code>, the <code>panels</code> won’t be
changed):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h1</span> <span class="op">&lt;-</span> <span class="va">h</span> <span class="op">+</span> <span class="fu"><a href="../reference/align_dendro.html">align_dendro</a></span><span class="op">(</span>reorder_group <span class="op">=</span> <span class="cn">FALSE</span>, merge_dendrogram <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># always remember dendrogram will initialize the index, here, we extract the</span></span>
<span><span class="co"># index from the underlying dendrogram</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html" class="external-link">order.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="../reference/ggalign_stat.html">ggalign_stat</a></span><span class="op">(</span><span class="va">h1</span>, <span class="st">"top"</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>However, if a dendrogram with <code>reorder_group = TRUE</code> is
then added, it will reorder the panels, so the underlying index will be
changed:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="va">h</span> <span class="op">+</span> <span class="fu"><a href="../reference/align_dendro.html">align_dendro</a></span><span class="op">(</span>reorder_group <span class="op">=</span> <span class="cn">TRUE</span>, merge_dendrogram <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">new_index</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html" class="external-link">order.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="../reference/ggalign_stat.html">ggalign_stat</a></span><span class="op">(</span><span class="va">h2</span>, <span class="st">"top"</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">index</span> <span class="op">==</span> <span class="va">new_index</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>To prevent reordering of the axis twice, we ensure that the
<code>new_index</code> matches the <code>index</code> (if
<code>index</code> is not NULL). This is done to maintain consistency
and prevent conflicts in the ordering of the heatmap.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggalign_1.0.1 ggplot2_3.5.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        compiler_4.4.3    </span></span>
<span><span class="co">#&gt;  [5] tidyselect_1.2.1   jquerylib_0.1.4    systemfonts_1.2.2  scales_1.3.0      </span></span>
<span><span class="co">#&gt;  [9] textshaping_1.0.0  yaml_2.3.10        fastmap_1.2.0      R6_2.6.1          </span></span>
<span><span class="co">#&gt; [13] labeling_0.4.3     generics_0.1.3     knitr_1.50         htmlwidgets_1.6.4 </span></span>
<span><span class="co">#&gt; [17] tibble_3.2.1       desc_1.4.3         munsell_0.5.1      bslib_0.9.0       </span></span>
<span><span class="co">#&gt; [21] pillar_1.10.2      RColorBrewer_1.1-3 rlang_1.1.5        cachem_1.1.0      </span></span>
<span><span class="co">#&gt; [25] xfun_0.52          fs_1.6.5           sass_0.4.9         cli_3.6.4         </span></span>
<span><span class="co">#&gt; [29] pkgdown_2.1.1      withr_3.0.2        magrittr_2.0.3     digest_0.6.37     </span></span>
<span><span class="co">#&gt; [33] grid_4.4.3         lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.3    </span></span>
<span><span class="co">#&gt; [37] glue_1.8.0         farver_2.1.2       ragg_1.3.3         colorspace_2.1-1  </span></span>
<span><span class="co">#&gt; [41] rmarkdown_2.29     tools_4.4.3        pkgconfig_2.0.3    htmltools_0.5.8.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yun Peng, Shixiang Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
