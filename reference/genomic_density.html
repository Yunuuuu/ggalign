<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Genomic Region Density — genomic_density • ggalign</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Genomic Region Density — genomic_density"><meta name="description" content="Computes the density or count of genomic regions in sliding or fixed windows
across the genome. The density can be reported as the percentage of uncovered
bases or the number of overlapping regions within each window."><meta property="og:description" content="Computes the density or count of genomic regions in sliding or fixed windows
across the genome. The density can be reported as the percentage of uncovered
bases or the number of overlapping regions within each window."><meta property="og:image" content="https://yunuuuu.github.io/ggalign/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggalign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="https://yunuuuu.github.io/ggalign-book/" aria-label="Tutorial"><span class="fa fa-solid fa-book"></span> Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="https://yunuuuu.github.io/ggalign-gallery/" aria-label="Gallery"><span class="fa fa-solid fa-grip"></span> Gallery</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/benchmarks.html"><span class="fa fa-solid fa-chart-line"></span> Benchmarks</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/FAQ.html"><span class="fa fa-solid fa-clipboard-question"></span> FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Yunuuuu/ggalign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Genomic Region Density</h1>
      <small class="dont-index">Source: <a href="https://github.com/Yunuuuu/ggalign/blob/main/R/genomic-helper.R" class="external-link"><code>R/genomic-helper.R</code></a></small>
      <div class="d-none name"><code>genomic_density.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the density or count of genomic regions in sliding or fixed windows
across the genome. The density can be reported as the percentage of uncovered
bases or the number of overlapping regions within each window.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">genomic_density</span><span class="op">(</span></span>
<span>  <span class="va">region</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">1e+07</span>,</span>
<span>  n_window <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overlap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coverage"</span>, <span class="st">"count"</span><span class="op">)</span>,</span>
<span>  seqlengths <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>A data frame with at least 3 columns: chromosome, start, and
end.</p><ul><li><p>Column 1: character or factor, chromosome name.</p></li>
<li><p>Column 2: numeric, start position (must be ≤ end).</p></li>
<li><p>Column 3: numeric, end position.</p></li>
</ul></dd>


<dt id="arg-window-size">window_size<a class="anchor" aria-label="anchor" href="#arg-window-size"></a></dt>
<dd><p>Numeric, the width of each window (default is <code>1e+07</code>).
Ignored if <code>n_window</code> is specified.</p></dd>


<dt id="arg-n-window">n_window<a class="anchor" aria-label="anchor" href="#arg-n-window"></a></dt>
<dd><p>Integer, the number of windows per chromosome. If provided,
overrides <code>window_size</code> and evenly splits the chromosome into <code>n_window</code>
(non-overlapping) or <code>2*n_window - 1</code> (overlapping) windows.</p></dd>


<dt id="arg-overlap">overlap<a class="anchor" aria-label="anchor" href="#arg-overlap"></a></dt>
<dd><p>Logical, whether to use overlapping windows (default <code>TRUE</code>).
Overlapping windows are spaced by half the window size.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Character, either <code>"coverage"</code> or <code>"count"</code>:</p><ul><li><p><code>"count"</code>: reports the number of regions overlapping each window.</p></li>
<li><p><code>"coverage"</code>: reports the fraction of each window covered by regions.</p></li>
</ul></dd>


<dt id="arg-seqlengths">seqlengths<a class="anchor" aria-label="anchor" href="#arg-seqlengths"></a></dt>
<dd><p>Optional named vector of chromosome lengths. If missing,
the maximum <code>end</code> value in the input is used as the chromosome length.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with columns:</p><ul><li><p><code>seqnames</code>: The sequence (e.g., chromosome) names.</p></li>
<li><p><code>start</code>: start of each window</p></li>
<li><p><code>end</code>: end of each window</p></li>
<li><p><code>density</code>: the region count or covered percent, depending on <code>mode</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function splits the input by chromosome and tiles the genomic space
into windows, optionally overlapping. For each window, it calculates:</p><ul><li><p>the number of regions that overlap it (if <code>mode = "count"</code>), or</p></li>
<li><p>the fraction of bases covered by any region (if <code>mode = "percent"</code>).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5000000</span>, <span class="fl">15000000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000000</span>, <span class="fl">7000000</span>, <span class="fl">17000000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">genomic_density</span><span class="op">(</span><span class="va">region</span>, window_size <span class="op">=</span> <span class="fl">1e7</span>, mode <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqnames   start      end density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     chr1       1 10000000       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     chr1 5000001 15000000       2</span>
<span class="r-in"><span><span class="fu">genomic_density</span><span class="op">(</span><span class="va">region</span>, n_window <span class="op">=</span> <span class="fl">3</span>, overlap <span class="op">=</span> <span class="cn">FALSE</span>, mode <span class="op">=</span> <span class="st">"coverage"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqnames    start      end   density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     chr1        1  5666667 0.4705710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     chr1  5666667 11333334 0.2352942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     chr1 11333334 17000001 0.3529413</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yun Peng, Shixiang Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

