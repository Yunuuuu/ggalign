<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reorder or Group layout based on hierarchical clustering — align_dendro • ggalign</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reorder or Group layout based on hierarchical clustering — align_dendro"><meta name="description" content="Reorder or Group layout based on hierarchical clustering"><meta property="og:description" content="Reorder or Group layout based on hierarchical clustering"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggalign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/layout-heatmap.html">Heatmap Layout</a></li>
    <li><a class="dropdown-item" href="../articles/align-layout.html">Layout Customization</a></li>
    <li><a class="dropdown-item" href="../articles/align-plot.html">Plot Integration</a></li>
    <li><a class="dropdown-item" href="../articles/layout-stack.html">Stack Layout</a></li>
    <li><a class="dropdown-item" href="../articles/scales-and-facets.html">Scales and Facets</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip> </h6></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">FAQ</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ComplexHeatmap</h6></li>
    <li><a class="dropdown-item" href="../articles/single-heatmap.html">ComplexHeatmap: single-heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/more-examples.html">ComplexHeatmap: more examples</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Yunuuuu/ggalign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reorder or Group layout based on hierarchical clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/Yunuuuu/ggalign/blob/main/R/align-dendrogram.R" class="external-link"><code>R/align-dendrogram.R</code></a></small>
      <div class="d-none name"><code>align_dendro.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Reorder or Group layout based on hierarchical clustering</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">align_dendro</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"complete"</span>,</span>
<span>  use_missing <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span>,</span>
<span>  reorder_group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_dendrogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_cut_height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  root <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rectangle"</span>,</span>
<span>  size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free_labs <span class="op">=</span> <span class="fu">waiver</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  free_sizes <span class="op">=</span> <span class="fu">waiver</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plot_data <span class="op">=</span> <span class="fu">waiver</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  set_context <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mapping">mapping<a class="anchor" aria-label="anchor" href="#arg-mapping"></a></dt>
<dd><p>Additional default list of aesthetic mappings to use for plot.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to
<a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment()</a>.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>A string of distance measure to be used. This must be one of
<code>"euclidean"</code>, <code>"maximum"</code>, <code>"manhattan"</code>, <code>"canberra"</code>, <code>"binary"</code> or
<code>"minkowski"</code>.  Correlation coefficient can be also used, including
<code>"pearson"</code>, <code>"spearman"</code> or <code>"kendall"</code>. In this way, <code>1 - cor</code> will be used
as the distance. In addition, you can also provide a <a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a>
object directly or a function return a <a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a> object.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A string of the agglomeration method to be used. This should be
(an unambiguous abbreviation of) one of <code>"ward.D"</code>, <code>"ward.D2"</code>, <code>"single"</code>,
<code>"complete"</code>, <code>"average"</code> (= UPGMA), <code>"mcquitty"</code> (= WPGMA), <code>"median"</code> (=
WPGMC) or <code>"centroid"</code> (= UPGMC). you can also provide a function which
returns a <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a> object.</p></dd>


<dt id="arg-use-missing">use_missing<a class="anchor" aria-label="anchor" href="#arg-use-missing"></a></dt>
<dd><p>An optional character string giving a method for computing
covariances in the presence of missing values. This must be (an abbreviation
of) one of the strings <code>"everything"</code>, <code>"all.obs"</code>, <code>"complete.obs"</code>,
<code>"na.or.complete"</code>, or <code>"pairwise.complete.obs"</code>. Only used when <code>distance</code>
is a correlation coefficient string.</p></dd>


<dt id="arg-reorder-group">reorder_group<a class="anchor" aria-label="anchor" href="#arg-reorder-group"></a></dt>
<dd><p>A single boolean value, indicates whether we should do
Hierarchical Clustering between groups, only used when previous groups have
been established.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>An integer scalar indicates the desired number of groups.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>A numeric scalar indicates heights where the tree should be cut.</p></dd>


<dt id="arg-plot-dendrogram">plot_dendrogram<a class="anchor" aria-label="anchor" href="#arg-plot-dendrogram"></a></dt>
<dd><p>A boolean value indicates whether plot the dendrogram
tree.</p></dd>


<dt id="arg-plot-cut-height">plot_cut_height<a class="anchor" aria-label="anchor" href="#arg-plot-cut-height"></a></dt>
<dd><p>A boolean value indicates whether plot the cut height.</p></dd>


<dt id="arg-root">root<a class="anchor" aria-label="anchor" href="#arg-root"></a></dt>
<dd><p>A length one string or numeric indicates the root branch.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>A boolean value. if <code>TRUE</code>, nodes are plotted centered with
respect to the leaves in the branch. Otherwise (default), plot them in the
middle of all direct child nodes.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A string indicates the plot type, <code>"rectangle"</code> or <code>"triangle"</code>.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>Plot size, can be an <a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a> object.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A matrix, a data frame, or even a simple vector that will be
converted into a one-column matrix. If the <code>data</code> argument is set to <code>NULL</code>,
the <code>align_*</code> will use the <code>layout</code> data. Additionally, the <code>data</code> argument
can also accept a function (purrr-like lambda is also okay), which will be
applied with the <code>layout</code> data,</p>
<p>It is important to note that all <code>align_*</code> functions consider the <code>rows</code> as
the observations. It means the <code>NROW(data)</code> must return the same number with
the parallel <code>layout</code> axis.</p><ul><li><p><code>layout_heatmap</code>: for column annotation, the <code>layout</code> data will be
transposed before using (If data is a <code>function</code>, it will be applied with
the transposed matrix). This is necessary because column annotation uses
heatmap columns as observations, but we need rows.</p></li>
<li><p><code>layout_stack</code>: the <code>layout</code> data will be used as it is since we place all
plots along a single axis.</p></li>
</ul></dd>


<dt id="arg-free-labs">free_labs<a class="anchor" aria-label="anchor" href="#arg-free-labs"></a></dt>
<dd><p>A boolean value or a character of the axis position (<code>"t"</code>,
<code>"l"</code>, <code>"b"</code>, <code>"r"</code>) indicates which axis title should be free from
alignment. By default, all axis title won't be aligned.</p></dd>


<dt id="arg-free-sizes">free_sizes<a class="anchor" aria-label="anchor" href="#arg-free-sizes"></a></dt>
<dd><p>A character specifies the ggplot elements which won't
count space sizes when alignment.</p></dd>


<dt id="arg-plot-data">plot_data<a class="anchor" aria-label="anchor" href="#arg-plot-data"></a></dt>
<dd><p>A function used to transform the plot data before rendering.
By default, it'll inherit from the parent layout. If no parent layout, the
default is to not modify the data. Use <code>NULL</code>, if you don't want to modify
anything.</p>
<p>Used to modify the data after layout has been created, but before the data is
handled of to the ggplot2 for rendering. Use this hook if the you needs
change the default data for all <code>geoms</code>.</p></dd>


<dt id="arg-set-context">set_context<a class="anchor" aria-label="anchor" href="#arg-set-context"></a></dt>
<dd><p>A single boolean value indicates whether to set the active
context to current plot. If <code>TRUE</code>, all subsequent ggplot elements will be
added into this plot.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>An single integer for the layout order.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A string of the plot name. Used to switch the active context in
<code><a href="hmanno.html">hmanno()</a></code> or <code><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A new <code>Align</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="ggplot-specification">ggplot2 specification<a class="anchor" aria-label="anchor" href="#ggplot-specification"></a></h2>


<p><code>align_dendro</code> initializes a <code>ggplot</code> data and <code>mapping</code>.</p>
<p>The internal will always use a default mapping of <code>aes(x = .data$x, y = .data$y)</code>.</p>
<p>The default ggplot data is the <code>node</code> coordinates, in addition, a
<a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a> layer with a data of the tree segments
<code>edge</code> coordinates will be added.</p>
<p><code>node</code> and tree segments <code>edge</code> coordinates contains following columns:</p><ul><li><p><code>index</code>: the original index in the tree for the current node</p></li>
<li><p><code>label</code>: node label text</p></li>
<li><p><code>x</code> and <code>y</code>: x-axis and y-axis coordinates for current node or the start
node of the current edge.</p></li>
<li><p><code>xend</code> and <code>yend</code>: the x-axis and y-axis coordinates of the terminal node
for current edge.</p></li>
<li><p><code>branch</code>: which branch current node or edge is. You can use this column
to color different groups.</p></li>
<li><p><code>panel</code>: which panel current node is, if we split the plot into panel
using <a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a>, this column will show
which panel current node or edge is from. Note: some nodes may
fall outside panel (between two panel), so there are possible
<code>NA</code> values in this column. We also provide <code>.panel</code> column,
which always give the right branch for usage of the ggplot
facet.</p></li>
<li><p><code>.panel</code>: See <code>panel</code>, this is what we often used.</p></li>
<li><p><code>panel1</code> and <code>panel2</code>: The panel1 and panel2 variables have the same
functionality as <code>panel</code>, but they are specifically for the <code>edge</code> data
and correspond to both nodes of each edge.</p></li>
<li><p><code>leaf</code>: A logical value indicates whether current node is a leaf.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="dendrogram_data.html">dendrogram_data()</a></code></p></li>
<li><p><code><a href="hclust2.html">hclust2()</a></code></p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="layout_heatmap.html">ggheatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">81</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="hmanno.html">hmanno</a></span><span class="op">(</span><span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">align_dendro</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="align_dendro-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="layout_heatmap.html">ggheatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">81</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="hmanno.html">hmanno</a></span><span class="op">(</span><span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">align_dendro</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="align_dendro-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yun Peng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

